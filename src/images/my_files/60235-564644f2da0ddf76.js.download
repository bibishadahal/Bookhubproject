"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[60235],{60235:function(i,e,t){t.d(e,{Oy:function(){return I},DJ:function(){return R},_Y:function(){return N},av:function(){return Z},V9:function(){return k}});var n=t(26042),r=t(69396),o=t(99534),u=t(36305),s=t(18721),a=t.n(s),c=t(40821),d=t(85672),l=t(331),p=t(19576),v=t(98510),b=t(8062),f=t(36311),S=t(48497),m=t(90819),g=t(19805),y=t(93636),C=t(36839),w=t(75957),x=t(14587),D=t(96360),U=[{name:"years",unit:"Y"},{name:"months",unit:"M"},{name:"weeks",unit:"W"},{name:"days",unit:"D"}],_=RegExp(["P"].concat((0,u.Z)(U.map(function(i){var e=i.name,t=i.unit;return"((?<".concat(e,">-?\\d+)").concat(t,")?")}))).join("")),h=function(i){var e=_.exec(i);if(!e||!e.groups)return[];var t=e.groups;return U.reduce(function(i,e){var n=e.name,r=parseInt(t[n],10);return Number.isNaN(r)||i.push({name:n,value:r}),i},[])},P={years:function(i){var e=i.date,t=i.numberOfUnits;return e.setUTCFullYear(e.getUTCFullYear()-t),e},months:function(i){var e=i.date,t=i.numberOfUnits;return e.setUTCMonth(e.getUTCMonth()-t),e},weeks:function(i){var e=i.date,t=i.numberOfUnits;return e.setUTCDate(e.getUTCDate()-7*t),e},days:function(i){var e=i.date,t=i.numberOfUnits;return e.setUTCDate(e.getUTCDate()-t),e}},T=function(i){var e=i.date,t=i.parsedDuration,n=new Date(e);return t.reduce(function(i,e){var t=e.name,n=e.value;return P[t]({date:i,numberOfUnits:n})},n).toISOString()},A=function(i){var e=i.date,t=i.duration;if(!e||!t)return null;try{var n=h(t);if(!n.length)return null;return T({date:e,parsedDuration:n})}catch(r){return null}},M={editorialImageSubscriptions:p.T_F,editorialImageCompSubscriptions:p.fuJ,editorialVideoSubscriptions:p.vWI,editorialVideoCompSubscriptions:p.Ujq,imageSubscriptions:p.xk7,imageCompSubscriptions:[p.Ixo],videoSubscriptions:p.S9k,videoCompSubscriptions:[p.f12],videoPremierSubscriptions:p.XmM,videoPremierSmSubscriptions:p.JI$,videoMediaSubscriptions:p.YVt,videoPlatformSubscriptions:p.Lj9,videoMediaSmSubscriptions:p.ISv,videoPremierSelectSubscriptions:[p.Mbf],videoMediaSelectSubscriptions:[p.Gap],musicSubscriptions:p.xq7,musicCompSubscriptions:p.Yem,sfxSubscriptions:p.dCf,sfxCompSubscriptions:p.uZM,flexSubscriptions:p.zUo,creativeFlowPlusSubscription:p.FLW,apiPlanSubscription:p.px9},F=function(i){var e,t,n=i.types,r=i.subscription,o=null==r?void 0:null===(e=r.product)||void 0===e?void 0:e.reportingBusinessUnit.toLowerCase().trim(),u=null==r?void 0:null===(t=r.product)||void 0===t?void 0:t.businessUnit;return!a()(r,"redeemableFor")&&[p.T2Y,p.A7v].includes(u)&&[p.aTO,p.FLW,p.px9].includes(o)||a()(r,"redeemableFor")&&p.T2Y===u&&p.px9===o?n.includes(o):n.includes(null==r?void 0:r.redeemableFor)||!a()(r,"redeemableFor")&&n.includes(u)},O=function(i){var e,t,o,u,s,a=i.activeSubscriptions,c=i.subscriptions;if(!c)return{};var d=function(i){return A({date:i.subscriptionExpiration,duration:i.duration})},l=function(i,e){var t=i.startDate;return e.startDate-t},p=a.map(function(i){return(0,r.Z)((0,n.Z)({},i),{startDate:new Date(d(i))})}).sort(l)[0]||c.map(function(i){return(0,r.Z)((0,n.Z)({},i),{startDate:new Date(d(i))})}).sort(l)[0];return p?{orderType:p.purchaseType,subscriptionId:p.id,subscriptionPermissionsExpireDate:p.subscriptionExpiration,autoRenewal:p.autoRenewal?String(p.autoRenewal):void 0,productTextId:null==p?void 0:null===(e=p.product)||void 0===e?void 0:e.name,productLengthTerm:p.duration,productDownloadAllotment:(null===(t=p.product)||void 0===t?void 0:t.downloadCredits)?String(null===(o=p.product)||void 0===o?void 0:o.downloadCredits):void 0,productReportingBusinessUnit:null===(u=p.product)||void 0===u?void 0:u.reportingBusinessUnit,productCategory:null===(s=p.product)||void 0===s?void 0:s.revenueModelDetail}:{}},R=function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=i.queryParams,t=(void 0===e?{}:e).expiringAfter,r=void 0===t?null:t,o=i.config,u=void 0===o?{}:o,s=(0,g.B)(),a=(0,g.j)().data,l=(0,n.Z)({user:null==a?void 0:a.id,organization:null==a?void 0:a.organizationId},r&&{expiring_after:r}||{}),p=(0,d.ec)({queryParams:l}).formattedUrl;return(0,c.ZP)(s?p:null,function(){return w.uS.get(p,u).then(function(i){return(0,x.O)(i.data)})},{dedupingInterval:v.no})},I=function(i){return i.reduce(function(i,e){return Object.keys(M).forEach(function(t){F({types:M[t],subscription:e})&&i[t].push((0,r.Z)((0,n.Z)({},e),{type:t}))}),i},{editorialImageSubscriptions:[],editorialImageCompSubscriptions:[],editorialVideoSubscriptions:[],editorialVideoCompSubscriptions:[],imageSubscriptions:[],imageCompSubscriptions:[],videoSubscriptions:[],videoCompSubscriptions:[],videoPremierSubscriptions:[],videoPremierSmSubscriptions:[],videoMediaSubscriptions:[],videoMediaSmSubscriptions:[],videoPlatformSubscriptions:[],videoPremierSelectSubscriptions:[],videoMediaSelectSubscriptions:[],musicSubscriptions:[],musicCompSubscriptions:[],sfxSubscriptions:[],sfxCompSubscriptions:[],flexSubscriptions:[],creativeFlowPlusSubscription:[],apiPlanSubscription:[]})},Z=function(){var i,e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.expiringAfter,s=t.onlyActive,a=t.config,c=(0,g.B)(),d=(0,S.D)().isBrandEnterprise,l=(0,y.U)(),p=l.isLoading,v=(0,o.Z)(l,["isLoading"]),b=R({queryParams:{expiringAfter:void 0===r?null:r},config:void 0===a?{}:a}),m=b.data,w=b.mutate,x=(0,C.w)().data,D=(void 0===x?{}:x).data;if(p||c&&void 0===m)return{data:void 0};var U=Array.isArray(m)?null==m?void 0:m.filter(function(i){return"active"===i.status}):[],_=Array.isArray(m)?O({activeSubscriptions:U,subscriptions:m}):{};if((0,f.Kc)({userCapabilities:v})){var h=(0,f.cT)({userCapabilities:v,subscriptions:m}),P=h.formattedSubscriptions,T=h.debitableSubscriptionInfo;i=P,e=T}var A=I(d&&i||(void 0!==s&&s?U:m)||[]),M=(void 0===D?{}:D).attributes,F=(void 0===M?{}:M).lifetimeProducts,Z=(void 0===F?null:F)||Array.isArray(m)&&m&&m.length||0;return{data:(0,n.Z)({allSubscriptions:Object.values(A).reduce(function(i,e){return(0,u.Z)(i).concat((0,u.Z)(e))},[]),activeSubscriptions:U,mostRecentSubscription:_,totalNumSubscriptionsAllTime:Z,totalNumSubscriptionsActive:U&&U.length||0},A,e),mutate:w}},k=function(){var i=(0,g.B)(),e=Z({});return!1===i?{data:{activeSubscriptions:[],allSubscriptions:[],mostRecentSubscription:void 0,totalNumSubscriptionsActive:0,totalNumSubscriptionsAllTime:0}}:e},N=function(){var i=(0,m.D)({namespace:D.pDn,translationKeys:{autoRenewOnSuccess:"notifications:label_auto_renew_success_on",autoRenewOffSuccess:"notifications:label_auto_renew_success_off",genericFailure:"notifications:label_generic_failure",cancelSubscriptionSuccess:"notifications:subscription_cancellation_success_message",cancelSubscriptionFailure:"notifications:cancellable_error_message"}}).labels,e=(0,b.D)().enqueueSnackbar;return{notifyAutoRenewOnSuccess:function(){e({alertSeverity:l.MR,message:i.autoRenewOnSuccess})},notifyAutoRenewOffSuccess:function(){e({alertSeverity:l.MR,message:i.autoRenewOffSuccess})},notifyCancelSubscriptionSuccess:function(){e({alertSeverity:l.MR,message:i.cancelSubscriptionSuccess})},notifyFailure:function(){e({alertSeverity:l.cM,message:i.genericFailure})},notifyCancelSubscriptionFailure:function(){e({alertSeverity:l.cM,message:i.cancelSubscriptionFailure})}}}},36839:function(i,e,t){t.d(e,{w:function(){return s}});var n=t(40821),r=t(85672),o=t(19805),u=t(75957),s=function(){var i=(0,o.B)(),e=(0,r.sY)().formattedUrl;return(0,n.ZP)(i?e:null,function(){return u.uS.get(e).then(function(i){return i.data})})}}}]);
//# sourceMappingURL=60235-564644f2da0ddf76.js.map